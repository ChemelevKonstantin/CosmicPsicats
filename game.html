<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8" />
<title>–ö–æ—Å–º—ñ—á–Ω—ñ –ü—Å–∏–∫–æ—Ç–∏ ‚Äì –ú–µ–Ω—é</title>
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
<style>
:root{
  --g0:#0b0c0f;--g1:#14161b;--g2:#1f2127;--g3:#2b2f37;
  --white:#f5f5f5;--muted:#c7c7c7;
  --accent:#ffdd4a;--accent-soft:#fff3a3;
  --rad:18px;--t:0.26s ease-out;
}
*{box-sizing:border-box;margin:0;padding:0;font-family:system-ui,-apple-system,"Segoe UI",sans-serif;-webkit-tap-highlight-color:transparent}
html,body{height:100%;}
body{min-height:100vh;background:linear-gradient(180deg,var(--g1),var(--g0));color:var(--white);overflow:hidden}
.app{max-width:480px;margin:0 auto;padding:8px 10px 10px;min-height:100vh;height:100vh;display:flex;flex-direction:column;position:relative;z-index:1}
.bg-noise{position:fixed;inset:0;pointer-events:none;opacity:.35;z-index:0;background-image:url("data:image/svg+xml;base64,PHN2ZyB3aWR0aD0nMTAnIGhlaWdodD0nMTAnIHZpZXdCb3g9JzAgMCAxMCAxMCcgeG1sbnM9J2h0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnJz48ZyBmaWxsPSdyZ2JhKDAsMCwwLDAuMyknPjxyZWN0IHg9JzAnIHk9JzAnIHdpZHRoPScxJyBoZWlnaHQ9JzEnIC8+PHJlY3QgeD0nNScgeT0nNScgd2lkdGg9JzEnIGhlaWdodD0nMScgLz48L2c+PC9zdmc+");background-size:6px 6px}
header{display:flex;align-items:center;justify-content:space-between;padding:4px 2px 8px}
.logo-wrap{display:flex;align-items:center;gap:10px}
.logo-box{width:44px;height:44px;border-radius:12px;background:transparent;display:flex;align-items:center;justify-content:center;font-size:22px;font-weight:900;color:var(--accent);animation:logoFloat 2.6s ease-in-out infinite;cursor:pointer;}
#gameLogo{  background: url('images/logo.png') center/cover no-repeat;}
@keyframes logoFloat{0%{transform:translateY(0)}50%{transform:translateY(-2px) scale(1.03)}100%{transform:translateY(0)}}
.game-title{display:flex;flex-direction:column;line-height:1.1}
.game-title-main{text-transform:uppercase;font-size:16px;letter-spacing:.1em;font-weight:800;color:var(--accent);cursor:pointer}
.game-title-sub{font-size:11px;letter-spacing:.14em;color:var(--muted)}
.header-actions{display:flex;align-items:center;gap:6px}
.icon-btn{
  width:34px;
  height:34px;
  border-radius:999px;
  border:none;
  background-size:70%;
  background-position:center;
  background-repeat:no-repeat;
  background-color:transparent;
  font-size:20px;
  color:var(--accent);
  display:flex;
  align-items:center;
  justify-content:center;
  cursor:pointer;
}
.coin-btn{width:34px;height:34px;border-radius:999px;border:none;background:transparent;color:#1e1600;font-size:18px;display:flex;align-items:center;justify-content:center;cursor:pointer}
main{flex:1;position:relative;overflow:hidden}
.screen{position:absolute;inset:0;padding-bottom:4px;display:flex;align-items:stretch;justify-content:center;opacity:0;pointer-events:none;transform:translateY(22px) scale(0.96);transition:opacity var(--t),transform var(--t)}
.screen.active{opacity:1;pointer-events:auto;transform:translateY(0) scale(1)}
.card{width:100%;max-width:480px;background:rgba(15,16,22,.94);border-radius:var(--rad);border:1px solid var(--g3);padding:12px 14px 10px;backdrop-filter:blur(10px);box-shadow:0 10px 22px rgba(0,0,0,.6);display:flex;flex-direction:column;min-height:100%;}
.tag{text-transform:uppercase;font-size:11px;letter-spacing:.18em;color:var(--accent-soft);margin-bottom:6px}
.hero-main{display:flex;align-items:center;gap:14px}
.hero-avatar{
  width:80px;
  height:80px;
  border-radius:16px;
  background:center/cover no-repeat;}
.hero-text{flex:1}
.hero-title{font-size:18px;font-weight:800;margin-bottom:4px;color:var(--white)}
.hero-desc{font-size:12px;color:var(--muted)}
.progress-row{display:flex;gap:6px;flex-wrap:wrap;margin-top:6px;font-size:10px;align-items:center}
.badge{border-radius:999px;padding:3px 8px;background:var(--g2);border:1px solid var(--g3);color:var(--accent-soft)}
.badge-label{background:transparent;border:none;color:var(--muted);padding-left:0}
.btn-col{display:flex;flex-direction:column;gap:8px;margin-top:12px}
.btn{border:none;border-radius:999px;padding:12px 14px;display:flex;align-items:center;justify-content:center;gap:8px;font-size:14px;font-weight:800;text-transform:uppercase;letter-spacing:.14em;cursor:pointer;transition:transform .14s ease-out,box-shadow .14s ease-out,background .14s ease-out}
.btn-primary{background:var(--accent);color:#1e1600;}
.btn-secondary{background:var(--g2);color:var(--white);border:1px solid var(--g3)}
.btn-mini{border:none;border-radius:999px;padding:6px 10px;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.12em;background:var(--accent);color:#1e1600;cursor:pointer}
.btn:active,.btn-mini:active{transform:translateY(1px) scale(.97);box-shadow:none}
.quick-row{margin-top:6px;display:flex;justify-content:space-between;font-size:11px;color:var(--muted)}
.footer{margin-top:auto;display:flex;justify-content:space-between;font-size:10px;color:var(--muted);padding-top:8px}
.top-row{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
.back-btn{border-radius:999px;border:1px solid var(--g3);background:var(--g2);color:var(--white);font-size:11px;padding:5px 9px;text-transform:uppercase;letter-spacing:.12em}
.breadcrumbs{font-size:11px;color:var(--muted)}
/* –°—Ç–µ–ø–ø–µ—Ä –≥–ª–∏–±–∏–Ω–∏ */
.stepper{display:flex;gap:4px;margin:4px 0 6px;font-size:10px}
.step-item{flex:1;padding:4px 6px;border-radius:999px;text-align:center;border:1px solid var(--g3);color:var(--muted);text-transform:uppercase;letter-spacing:.08em;cursor:pointer}
.step-item.active{background:var(--accent);color:#1e1600;border-color:var(--accent)}
.step-item.done{background:var(--g2);color:var(--accent-soft)}
.big-orb{flex-shrink:0;width:160px;height:160px;margin:0 auto 10px;border-radius:50%;background:radial-gradient(circle at 25% 20%,var(--accent-soft),var(--accent));display:flex;flex-direction:column;align-items:center;justify-content:center;color:#2a2200;box-shadow:0 0 0 3px #1a1500,0 0 22px rgba(255,221,74,.6);cursor:pointer;transition:transform .12s ease-out,box-shadow .12s ease-out}
.big-orb:active{transform:scale(0.97);box-shadow:0 0 0 2px #1a1500,0 0 16px rgba(255,221,74,.5)}
.big-orb.warp{animation:orbWarp .32s ease-out}
@keyframes orbWarp{0%{transform:scale(1)}60%{transform:scale(1.1)}100%{transform:scale(1)}}
.big-label{font-size:11px;text-transform:uppercase;letter-spacing:.16em;opacity:.9}
.big-name{font-size:17px;font-weight:800;margin-top:4px;text-align:center;padding:0 8px}
.big-meta{font-size:11px;margin-top:2px}
.list{margin-top:8px;display:flex;flex-direction:column;gap:6px;font-size:12px;overflow-y:auto;padding-bottom:4px}
.item{border-radius:12px;padding:8px 9px;background:var(--g2);border:1px solid var(--g3);display:flex;justify-content:space-between;align-items:center;cursor:pointer}
.item.active{border-color:var(--accent);box-shadow:0 0 0 1px var(--accent)}
.item.locked{opacity:.6}
.item-main{display:flex;flex-direction:column;gap:1px}
.item-name{font-weight:600}
.item-note{font-size:11px;color:var(--muted)}
.item-tag{font-size:11px;color:var(--accent-soft)}
/* –ó–æ–Ω–∏ */
.zone-header{font-size:11px;color:var(--muted);margin-bottom:4px}
.zone-grid{margin-top:4px;display:flex;flex-wrap:wrap;justify-content:center;gap:0;border-radius:12px;overflow:hidden;border:1px solid var(--g3);max-width:320px;margin-left:auto;margin-right:auto}
.zone-tile{width:50%;aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;background:#f2f2f2;color:#111;font-size:11px;border-right:1px solid #e0e0e0;border-bottom:1px —Å–æ–ªid #e0e0e0;cursor:pointer;position:relative}
.zone-tile:nth-child(2n){border-right:none}
.zone-label{display:flex;flex-direction:column;gap:2px;text-align:center}
.zone-num{font-weight:700}
.zone-danger{font-size:9px;text-transform:uppercase;letter-spacing:.08em}
.zone-tile.locked{background:#2b2f37;color:#777;border-color:#1a1c22}
.zone-tile.unlocked::after{content:"";position:absolute;inset:6px;border-radius:10px;border:2px solid var(--accent)}
.hint{text-align:center;font-size:11px;color:var(--muted);margin-top:6px}
/* –ú—ñ—Å—ñ–π–Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–∞ */
.mission-card{margin-top:8px;border-radius:12px;background:var(--g2);border:1px —Å–æ–ªid var(--g3);padding:8px 10px;font-size:11px;display:flex;flex-direction:column;gap:4px}
.mission-title{font-size:12px;font-weight:700}
.mission-desc{color:var(--muted)}
.mission-row{display:flex;justify-content:space-between;align-items:center;margin-top:2px}
.mission-reward{color:var(--accent-soft);font-size:11px}
/* –ö–æ—Ç–æ–ø–µ–¥—ñ—è */
.icon-with-text{display:flex;align-items:center;gap:8px;}
.icon-img{width:30px;height:30px;background-size:contain;background-repeat:no-repeat;background-position:center;font-size:18px;}

.cat-list{margin-top:8px;overflow-y:auto;font-size:12px;display:flex;flex-direction:column;gap:8px}
.cat-panel{border-radius:12px;background:var(--g2);border:1px —Å–æ–ªid var(--g3);overflow:hidden}
.cat-header{display:flex;align-items:center;justify-content:space-between;padding:8px 10px;cursor:pointer}
.cat-title-txt{text-transform:uppercase;font-size:11px;letter-spacing:.14em;color:var(--accent-soft)}
.cat-arrow{font-size:12px;color:var(--muted);transition:transform .18s ease-out}
.cat-panel.open .cat-arrow{transform:rotate(90deg)}
.cat-body{max-height:0;overflow:hidden;transition:max-height .22s ease-out,padding .18s ease-out;padding:0 10px}
.cat-panel.open .cat-body{padding:4px 10px 8px}
.cat-entry{margin-top:4px}
.cat-entry-name{font-weight:600;margin-bottom:2px;display:flex;justify-content:space-between;gap:6px}
.cat-entry-status{font-size:10px;color:var(--muted);white-space:nowrap}
.cat-entry-text{font-size:11px;color:var(--muted)}
.res-dropdown{position:absolute;right:10px;top:54px;width:220px;background:var(--g2);border-radius:14px;border:1px —Å–æ–ªid var(--g3);box-shadow:0 10px 22px rgba(0,0,0,.7);padding:8px 9px;font-size:12px;opacity:0;transform:translateY(-6px);pointer-events:none;transition:opacity var(--t),transform var(--t);z-index:3}
.res-dropdown.visible{opacity:1;transform:translateY(0);pointer-events:auto}

.hero-modal{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.65);
  display:flex;
  align-items:center;
  justify-content:center;
  opacity:0;
  pointer-events:none;
  transition:opacity .18s ease-out;
  z-index:6;
}
.hero-modal.visible{
  opacity:1;
  pointer-events:auto;
}
.hero-modal-card{
  width:85%;
  max-width:340px;
  background:var(--g2);
  border-radius:18px;
  border:1px solid var(--g3);
  box-shadow:0 14px 30px rgba(0,0,0,.8);
  padding:14px 14px 12px;
  display:flex;
  flex-direction:column;
  align-items:stretch;
}
.hero-modal-name{
  font-size:16px;
  font-weight:800;
  text-align:center;
  margin-bottom:8px;
  color:var(--accent-soft);
  text-transform:uppercase;
  letter-spacing:.12em;
}
.hero-modal-image{
  width:100%;
  aspect-ratio:1/1;
  border-radius:16px;
  background: center/cover no-repeat;}
.hero-modal-desc{
  margin-top:8px;
  font-size:12px;
  color:var(--muted);
  text-align:left;
}
.hero-modal-close{
  margin-top:10px;
  align-self:center;
  border:none;
  border-radius:999px;
  padding:8px 16px;
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:.12em;
  background:var(--accent);
  color:#1e1600;
  cursor:pointer;
}
.hero-modal-close:active{
  transform:translateY(1px) scale(.97);
  box-shadow:none;
}


.settings-dropdown{
  position:absolute;
  right:10px;
  top:54px;
  width:240px;
  background:var(--g2);
  border-radius:14px;
  border:1px solid var(--g3);
  box-shadow:0 10px 22px rgba(0,0,0,.7);
  padding:8px 9px;
  font-size:12px;
  opacity:0;
  transform:translateY(-6px);
  pointer-events:none;
  transition:opacity var(--t),transform var(--t);
  z-index:3;
}
.settings-dropdown.visible{opacity:1;transform:translateY(0);pointer-events:auto}
.settings-row{padding:4px 2px;display:flex;flex-direction:column;gap:4px}
.settings-title{
  font-size:11px;
  text-transform:uppercase;
  letter-spacing:.14em;
  color:var(--accent-soft);
  border-bottom:1px solid var(--g3);
  margin-bottom:4px;
  padding-bottom:4px;
}
.settings-label{font-size:11px;color:var(--muted)}
.settings-avatars{display:flex;flex-wrap:wrap;gap:6px;margin-top:2px}
.avatar-btn{
  flex:0 0 auto;
  min-width:auto;
  border-radius:10px;
  border:1px solid var(--g3);
  background:var(--g2);
  padding:4px;
  display:flex;
  align-items:center;
  justify-content:center; /* —Ü–µ–Ω—Ç—Ä –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–∫–∏ */
  font-size:0;            /* —â–æ–± –Ω–µ –±—É–ª–æ —Ç–µ–∫—Å—Ç–æ–≤–∏—Ö –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ñ–≤ */
  cursor:pointer;
}

.avatar-btn.active{
  border-color:var(--accent);
  color:var(--accent-soft);
  box-shadow:0 0 0 1px var(--accent);
}
.avatar-thumb{
  width:28px;
  height:28px;
  border-radius:8px;
  background:#222 center/cover no-repeat;
}
.avatar-name{
  flex:1;
  white-space:nowrap;
  overflow:hidden;
  text-overflow:ellipsis;
}

.res-row{display:flex;justify-content:space-between;align-items:center;padding:4px 4px;border-radius:8px}
.res-name{color:var(--muted);font-size:11px}
.res-val{color:var(--accent-soft);font-weight:700}
.toast{position:fixed;left:50%;bottom:16px;transform:translateX(-50%) translateY(100%);background:var(--g2);color:var(--white);border-radius:999px;border:1px —Å–æ–ªid var(--g3);padding:7px 11px;font-size:10px;text-transform:uppercase;letter-spacing:.12em;opacity:0;transition:opacity .16s ease-out,transform .16s ease-out;z-index:5}
.toast.visible{opacity:1;transform:translateX(-50%) translateY(0)}
</style>
</head>
<body>
<div class="bg-noise"></div>
<div class="app">
  <header>
    <div class="logo-wrap">
      <div class="logo-box" id="gameLogo"></div>
      <div class="game-title">
        <div class="game-title-main" id="titleMain">–ö–æ—Å–º—ñ—á–Ω—ñ –ü—Å–∏–∫–æ—Ç–∏</div>
        <div class="game-title-sub">–î–µ–º–æ–∫—Ä–∞—Ç—ñ—è —É –±—É–¥—å-—è–∫—É —Ç–æ—á–∫—É –≤—Å–µ—Å–≤—ñ—Ç—É</div>
      </div>
    </div>
    <div class="header-actions">
<button class="icon-btn" id="btnSettings" data-emoji="‚öôÔ∏è"></button>
<button class="icon-btn" id="btnCoin" data-emoji="ü™ô"></button>
</div>

  </header>
  <div class="res-dropdown" id="resDropdown">
    <div class="res-row"><span class="res-name">üé´ –¢–∞–ª–æ–Ω–∏ –î–µ–º–æ–∫—Ä–∞—Ç—ñ—ó</span><span class="res-val" id="rTickets">120</span></div>
    <div class="res-row"><span class="res-name">üèÖ –î–µ–º–æ–º–µ–¥–∞–ª—å–∫–∏</span><span class="res-val" id="rMedals">37</span></div>
    <div class="res-row"><span class="res-name">üí® –ì—ñ–ø–µ—Ä–ø—É–∫</span><span class="res-val" id="rPuke">3</span></div>
  </div>
  <!-- –∫–Ω–æ–ø–∫–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è -->
  <div class="settings-dropdown" id="settingsDropdown">
  <div class="settings-row settings-title">‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è</div>
  <div class="settings-row">
    <div class="settings-label">–ì–µ—Ä–æ—ó –Ω–∞—Ü—ñ—ó</div>
    <div class="settings-avatars" id="settingsAvatars"></div>
  </div>
</div>

  <main>
    <!-- HOME -->
    <section class="screen active" id="screen-home">
      <div class="card">
        <div class="tag">–ö–æ–º–∞–Ω–¥—É–≤–∞—á –æ—Ä–±—ñ—Ç–∞–ª—å–Ω–æ—ó —Å—Ç–∞–Ω—Ü—ñ—ó</div>
        <div class="hero-main">
          <div class="hero-avatar" id="playerAvatar"></div>
          <div class="hero-text">
            <div class="hero-title" id="playerNameDisplay">–ü–æ—Ö–µ—Ä–æ–∫–æ—Ç–æ</div>
            <div class="hero-desc" id="homeDesc">–ß–æ—Ä–Ω–∏–π —Å–∞–º—É—Ä–∞–π —É –≤–∏–≥–Ω–∞–Ω–Ω—ñ.</div>
            <div class="progress-row" id="homeProgress">
              <span class="badge badge-label">–ó–≤—ñ–ª—å–Ω–µ–Ω–æ:</span>
              <div class="badge" id="badgeGalaxy">0/0 –≥–∞–ª–∞–∫—Ç–∏–∫</div>
              <div class="badge" id="badgePlanet">0/0 –ø–ª–∞–Ω–µ—Ç</div>
              <div class="badge" id="badgeZone">0/0 –∑–æ–Ω</div>
            </div>
          </div>
        </div>
        <div class="btn-col">
          <button class="btn btn-primary" id="btnStart">–í–∏—Å–∞–¥–∏—Ç–∏—Å—è</button>
          <button class="btn btn-secondary" id="btnContinue">–ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏</button>
          <button class="btn btn-secondary icon-with-text" id="btnModes" data-emoji="üìö"><span class="icon-img" id="iconCatopedia"></span><span>–ö–æ—Ç–æ–ø–µ–¥—ñ—è</span></button>

        </div>
        <div class="quick-row">
          <span id="statusLine">–¢—É—Ç –±—É–≤: 03:44</span>
          <span>‚óè Online</span>
        </div>
        <div class="footer">
          <div><span>Made</span><span>ByMe</span></div>
          <div>build 0.9.1</div>
        </div>
      </div>
    </section>

    <!-- GALAXIES -->
    <section class="screen" id="screen-galaxies">
      <div class="card">
        <div class="top-row">
          <button class="back-btn" data-back="home">‚óÄ –ú–µ–Ω—é</button>
          <div class="breadcrumbs">–ì–∞–ª–∞–∫—Ç–∏–∫–∏</div>
        </div>
        <div class="stepper">
          <div class="step-item step-gal" data-target="galaxies">–ì–∞–ª–∞–∫—Ç–∏–∫–∏</div>
          <div class="step-item step-pl" data-target="planets">–ü–ª–∞–Ω–µ—Ç–∏</div>
          <div class="step-item step-zn" data-target="zones">–ó–æ–Ω–∏</div>
        </div>
        <div class="big-orb" id="galaxyOrb">
          <div class="big-label">–ì–∞–ª–∞–∫—Ç–∏–∫–∞</div>
          <div class="big-name" id="galaxyName">...</div>
          <div class="big-meta" id="galaxyMeta">...</div>
        </div>
        <div class="list" id="galaxyList"></div>
        <div class="footer">
          <div><span>Step 1 / 3</span></div>
          <div>Tap Galaxy / Orb</div>
        </div>
      </div>
    </section>

    <!-- PLANETS -->
    <section class="screen" id="screen-planets">
      <div class="card">
        <div class="top-row">
          <button class="back-btn" data-back="galaxies">‚óÄ –ì–∞–ª–∞–∫—Ç–∏–∫–∏</button>
          <div class="breadcrumbs" id="planetCrumbs">–ì–∞–ª–∞–∫—Ç–∏–∫–∞ ‚Ä¢ –ü–ª–∞–Ω–µ—Ç–∏</div>
        </div>
        <div class="stepper">
          <div class="step-item step-gal" data-target="galaxies">–ì–∞–ª–∞–∫—Ç–∏–∫–∏</div>
          <div class="step-item step-pl" data-target="planets">–ü–ª–∞–Ω–µ—Ç–∏</div>
          <div class="step-item step-zn" data-target="zones">–ó–æ–Ω–∏</div>
        </div>
        <div class="big-orb" id="planetOrb">
          <div class="big-label">–ü–ª–∞–Ω–µ—Ç–∞</div>
          <div class="big-name" id="planetName">...</div>
          <div class="big-meta" id="planetMeta">...</div>
        </div>
        <div class="list" id="planetList"></div>
        <div class="footer">
          <div><span>Step 2 / 3</span></div>
          <div>Tap Planet / Orb</div>
        </div>
      </div>
    </section>

    <!-- ZONES -->
    <section class="screen" id="screen-zones">
      <div class="card">
        <div class="top-row">
          <button class="back-btn" data-back="planets">‚óÄ –ü–ª–∞–Ω–µ—Ç–∏</button>
          <div class="breadcrumbs" id="zoneCrumbs">–ì–∞–ª–∞–∫—Ç–∏–∫–∞ ‚Ä¢ –ü–ª–∞–Ω–µ—Ç–∞ ‚Ä¢ –ó–æ–Ω–∏</div>
        </div>
        <div class="stepper">
          <div class="step-item step-gal" data-target="galaxies">–ì–∞–ª–∞–∫—Ç–∏–∫–∏</div>
          <div class="step-item step-pl" data-target="planets">–ü–ª–∞–Ω–µ—Ç–∏</div>
          <div class="step-item step-zn" data-target="zones">–ó–æ–Ω–∏</div>
        </div>
        <div class="zone-header" id="zoneHeaderInfo">–ì–∞–ª–∞–∫—Ç–∏–∫–∞: ? ‚Ä¢ –ü–ª–∞–Ω–µ—Ç–∞: ?</div>
        <div class="tag">Landing Zones</div>
        <div class="zone-grid" id="zoneGrid"></div>
        <div class="hint">–í—Å—ñ –∑–æ–Ω–∏ –æ–¥–Ω–∞–∫–æ–≤–æ–≥–æ —Ä–æ–∑–º—ñ—Ä—É. –ñ–æ–≤—Ç–∞ —Ä–∞–º–∫–∞ = –≤—ñ–¥–∫—Ä–∏—Ç–∞ –∑–æ–Ω–∞.</div>
        <div class="mission-card" id="missionCard">
          <div class="mission-title" id="missionTitle">–û–±–µ—Ä–∏ –∑–æ–Ω—É –¥–ª—è –≤–∏—Å–∞–¥–∫–∏</div>
          <div class="mission-desc" id="missionDesc">–ö–ª—ñ–∫–Ω–∏ –ø–æ –≤—ñ–¥–∫—Ä–∏—Ç—ñ–π –∑–æ–Ω—ñ, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –¥–µ—Ç–∞–ª—ñ –º—ñ—Å—ñ—ó.</div>
          <div class="mission-row">
            <span class="mission-reward" id="missionReward">–ù–∞–≥–æ—Ä–æ–¥–∞: ‚Äî</span>
            <button class="btn-mini" id="btnLaunchMission">–°—Ç–∞—Ä—Ç –º—ñ—Å—ñ—ó</button>
          </div>
        </div>
        <div class="footer">
          <div><span>Step 3 / 3</span></div>
          <div>Tap Zone & Launch</div>
        </div>
      </div>
    </section>

    <!-- CATOPEDIA -->
    <section class="screen" id="screen-catopedia">
      <div class="card">
        <div class="top-row">
          <button class="back-btn" data-back="home">‚óÄ –ú–µ–Ω—é</button>
          <div class="breadcrumbs">–ö–æ—Ç–æ–ø–µ–¥—ñ—è</div>
        </div>
        <div class="tag">–©–æ –º–∏ –∑–Ω–∞—î–º–æ –ø—Ä–æ —Ü–µ–π —Å–≤—ñ—Ç</div>
        <div class="cat-list" id="catList"></div>
        <div class="quick-row">
          <span id="catFact">üì° –†–∞–¥—ñ–æ: ...</span>
          <span>üìª</span>
        </div>
        <div class="footer">
          <div><span>Tap category to expand</span></div>
          <div>Catopedia v0.5</div>
        </div>
      </div>
    </section>
  </main>
</div>

<div class="hero-modal" id="heroModal">
  <div class="hero-modal-card">
    <div class="hero-modal-name" id="heroModalName">–ì–µ—Ä–æ–π</div>
    <div class="hero-modal-image" id="heroModalImage"></div>
    <div class="hero-modal-desc" id="heroModalDesc">
      –û–ø–∏—Å –≥–µ—Ä–æ—è –±—É–¥–µ —Ç—É—Ç.
    </div>
    <button class="hero-modal-close" id="heroModalClose">–ó–∞–∫—Ä–∏—Ç–∏</button>
  </div>
</div>


<div class="toast" id="toast"></div>
<script>
// –î–∞–Ω—ñ –≥—Ä–∏
const dataResources=[
  {id:'tickets',icon:'üé´',name:'–¢–∞–ª–æ–Ω–∏ –î–µ–º–æ–∫—Ä–∞—Ç—ñ—ó',desc:'–û—Ñ—ñ—Ü—ñ–π–Ω–∞ –≤–∞–ª—é—Ç–∞ –≥–∞–ª–∞–∫—Ç–∏—á–Ω–æ–≥–æ –≥–æ–ª–æ—Å—É–≤–∞–Ω–Ω—è. –ß–∏–º –±—ñ–ª—å—à–µ —Ç–∞–ª–æ–Ω—ñ–≤, —Ç–∏–º –≥—É—á–Ω—ñ—à–µ —Ç–≤—ñ–π –∫–æ—Ç—è—á–∏–π ¬´–º—è—É¬ª —É –ø–∞—Ä–ª–∞–º–µ–Ω—Ç—ñ.'},
  {id:'medals',icon:'üèÖ',name:'–î–µ–º–æ–º–µ–¥–∞–ª—å–∫–∏',desc:'–ë–ª–∏—Å–∫—É—á—ñ –∑–Ω–∞—á–∫–∏ –∑–∞ –æ—Å–æ–±–ª–∏–≤–æ –∞–±—Å—É—Ä–¥–Ω—ñ –¥–µ–º–æ–∫—Ä–∞—Ç–∏—á–Ω—ñ –ø–æ–¥–≤–∏–≥–∏. –ö–æ—Ç–∏ –ª—é–±–ª—è—Ç—å –Ω–æ—Å–∏—Ç–∏ —ó—Ö –Ω–∞–≤—ñ—Ç—å –Ω–∞ —Å–∫–∞—Ñ–∞–Ω–¥—Ä–∞—Ö.'},
  {id:'puke',icon:'üí®',name:'–ì—ñ–ø–µ—Ä–ø—É–∫',desc:'–†—ñ–¥–∫—ñ—Å–Ω–∏–π –µ–Ω–µ—Ä–≥–µ—Ç–∏—á–Ω–∏–π —Ä–µ—Å—É—Ä—Å –ø—ñ—Å–ª—è –Ω–µ–≤–¥–∞–ª–∏—Ö –µ–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç—ñ–≤ —ñ–∑ –∫–æ—Å–º—ñ—á–Ω–æ—é –∫–≤–∞—Å–æ–ª–µ—é. –î—É–∂–µ —Å–º–µ—Ä–¥–∏—Ç—å, –∞–ª–µ –ø–æ—Ç—É–∂–Ω–æ –∂–∏–≤–∏—Ç—å —Ç—É—Ä–µ–ª—ñ.'}
];
const avatarSkins=[
  {
    id:'poherocat',
    name:'–ü–æ—Ö–µ—Ä–æ–∫–æ—Ç–æ',
    file:'images/avatar_poherocat.png',
    heroName:'–ü–æ—Ö–µ—Ä–æ–∫–æ—Ç–æ',
    heroDesc:'–ß–æ—Ä–Ω–∏–π —Å–∞–º—É—Ä–∞–π —É –≤–∏–≥–Ω–∞–Ω–Ω—ñ.'
  },
  {
    id:'doggo',
    name:'–ü–µ—Å–¥–µ–Ω–∏–∫',
    file:'images/avatar_doggo.png',
    heroName:'–ü–µ—Å–¥–µ–Ω–∏–∫',
    heroDesc:'–í—ñ—Ä–Ω–∏–π –∫–æ—Å–º—ñ—á–Ω–∏–π –ø–µ—Å-–¥–µ—Å–∞–Ω—Ç–Ω–∏–∫.'
  },
    {
    id:'helmetcat',
    name:'–®—Ç—É—Ä–º–æ–∫—ñ—Ç',
    file:'images/avatar_helmetcat.png',
    heroName:'–®—Ç—É—Ä–º–æ–∫—ñ—Ç',
    heroDesc:'–ì–æ—Ç–æ–≤–∏–π –Ω–∞ –±—É–¥—å-—è–∫–∏–π –¥–≤—ñ–∂.'
  },
  {
    id:'dogdos',
    name:'–ü–µ—ÅDos',
    file:'images/avatar_hacker.png',
    heroName:'–ü–µ—ÅDos',
    heroDesc:'–ë—Ä–∞—Ç –ü–µ—Å–¥–µ–Ω–∏–∫–∞, –∑ IT, —è–∫–∏–π –ø—Ä–æ–≥—Ä–∞–º—É—î –≤ Dos.'
  }
];

const dataUnits=[
  {id:'cats',icon:'üê±',name:'–ö–æ—Ç–∏',desc:'–ï–ª—ñ—Ç–Ω—ñ –¥–µ—Å–∞–Ω—Ç–Ω–∏–∫–∏: –∑–∞–≤–∂–¥–∏ –ø—Ä–∏–∑–µ–º–ª—è—é—Ç—å—Å—è –Ω–∞ –ª–∞–ø–∏, –Ω–∞–≤—ñ—Ç—å —è–∫—â–æ –≤–∏—Å–∫–æ—á–∏–ª–∏ –∑ –¥—Ä–æ–ø–∞ –¥–æ–≥–æ—Ä–∏ –¥—Ä–∏–≥–æ–º.'},
  {id:'dogs',icon:'üê∂',name:'–ü–µ—Å–∏–∫–∏',desc:'–í—ñ–¥–¥–∞–Ω—ñ —à—Ç—É—Ä–º–æ–≤–∏–∫–∏ —Ç–∞ —Å–∞–ø–µ—Ä–∏. –Ø–∫—â–æ –ø–µ—Å–∏–∫ —â–æ—Å—å –ø—Ä–∏–Ω—ñ—Å ‚Äî —Ü–µ –∞–±–æ –≥—Ä–∞–Ω–∞—Ç–∞, –∞–±–æ –≤–∏–±–æ—Ä—á–∏–π –±—é–ª–µ—Ç–µ–Ω—å.'}
];
const dataEnemies=[
  {id:'puklings',icon:'üëæ',name:'–ü—É–∫–ª—ñ–Ω–≥–∏',desc:'–ú—É—Ç–∞–Ω—Ç–∏ –Ω–µ–∑—Ä–æ–∑—É–º—ñ–ª–æ–≥–æ –ø–æ—Ö–æ–¥–∂–µ–Ω–Ω—è: –Ω—ñ–±–∏ –∑–µ—Ä–ª—ñ–Ω–≥–∏, –∞–ª–µ —Ö—Ç–æ—Å—å —è–≤–Ω–æ –ø–µ—Ä–µ–±–æ—Ä—â–∏–≤ —ñ–∑ –ì—ñ–ø–µ—Ä–ø—É–∫–æ–º. –ü–æ–≤–∑–∞—é—Ç—å –∑–≥—Ä–∞—è–º–∏ –π –Ω–µ–Ω–∞–≤–∏–¥—è—Ç—å –±—é—Ä–æ–∫—Ä–∞—Ç—ñ—é.'}
];
const gameData={
  galaxies:[
    {
      id:'g1',
      name:'–î—É–ø–∞ —Å–≤—ñ—Ç—É',
      note:'–ù–∞–≤—á–∞–ª—å–Ω—ñ –∫–æ—Ç—è—á—ñ –≤–∏—Å–∞–¥–∫–∏.',
      lore:'–ü–µ—Ä–∏—Ñ–µ—Ä—ñ–π–Ω–∞ –≥–∞–ª–∞–∫—Ç–∏–∫–∞, –∫—É–¥–∏ –≤—ñ–¥–ø—Ä–∞–≤–ª—è—é—Ç—å —É—Å—ñ—Ö –Ω–æ–≤–∞—á–∫—ñ–≤. –Ø–∫—â–æ —Ç–∏ –≤–∏–∂–∏–≤ —Ç—É—Ç ‚Äî —Ç–∏ —â–µ –Ω—ñ—á–æ–≥–æ –Ω–µ –±–∞—á–∏–≤.',
      planets:[
        {
          id:'p1',
          name:'–õ–µ–Ω–¥—ñ–Ω–≥—ñ—è',
          note:'–ü–µ—Ä—à–∞ –ø–ª–∞–Ω–µ—Ç–∞ –¥–ª—è –¥–µ—Å–∞–Ω—Ç—É.',
          lore:'–ü—ñ—Å–æ–∫, –º—ñ–Ω–µ—Ä–∞–ª–∏ —Ç–∞ –º—É—Ç–∞–Ω—Ç–∏, —â–æ —Ç–µ—Ä–ø–ª—è—á–µ —á–µ–∫–∞—é—Ç—å, –ø–æ–∫–∏ —Ç–∏ —Ä–æ–∑–±–µ—Ä–µ—à—Å—è –∑ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è–º.',
          minerals:'–ë–∞–∑–æ–≤—ñ –º–µ—Ç–∞–ª–∏ –π —Ç—Ä—ñ—à–∫–∏ –≤–∏–±—É—Ö–æ–≤–∏—Ö –∫—Ä–∏—Å—Ç–∞–ª—ñ–≤.',
          politics:'–û—Ñ—ñ—Ü—ñ–π–Ω–æ: ¬´—Ç–∏–º—á–∞—Å–æ–≤–∞ –º–∏—Ä–æ—Ç–≤–æ—Ä—á–∞ –º—ñ—Å—ñ—è¬ª. –ù–µ–æ—Ñ—ñ—Ü—ñ–π–Ω–æ: —Ç—Ä–µ–Ω—É–≤–∞–ª—å–Ω–∏–π —Ç–∏—Ä.',
          zones:[
            {id:'z1',name:'–ü–ª—è–∂ –í–∏—Å–∞–¥–∫–∏',danger:'–õ–µ–≥–∫–∞',unlocked:true,reward:{tickets:5,medals:1,puke:0}},
            {id:'z2',name:'–ü–µ—Ä—à–∞ –®–∞—Ö—Ç–∞',danger:'–°–µ—Ä–µ–¥–Ω—è',unlocked:false,reward:{tickets:8,medals:1,puke:1}},
            {id:'z3',name:'–¢—É—Ä–µ–ª—å–Ω–∏–π –†—è–¥',danger:'–í–∏—Å–æ–∫–∞',unlocked:false,reward:{tickets:10,medals:2,puke:1}},
            {id:'z4',name:'Frontline-01',danger:'–°–µ—Ä–µ–¥–Ω—è',unlocked:false,reward:{tickets:7,medals:1,puke:1}}
          ]
        },
        {
          id:'p2',
          name:'–î–µ–º–æ–∫—Ä–∞—Ç—ñ—É–º',
          note:'–¢—É—Ç –≥–æ–ª–æ—Å—É—é—Ç—å –Ω–∞–≤—ñ—Ç—å –≥–∞—Ä–º–∞—Ç–∏.',
          lore:'–¶—ñ–ª–∞ –ø–ª–∞–Ω–µ—Ç–∞-—Ä–æ–±–æ—á–∞ –≥—Ä—É–ø–∞. –ö–æ–∂–µ–Ω –∫—Ä–∞—Ç–µ—Ä ‚Äî –∫–æ–º—ñ—Ç–µ—Ç, –∫–æ–∂–Ω–∞ —à–∞—Ö—Ç–∞ ‚Äî –ø—ñ–¥–∫–æ–º—ñ—Å—ñ—è.',
          minerals:'–†—ñ–¥–∫—ñ—Å–Ω—ñ —Å–ø–ª–∞–≤–∏ –¥–ª—è –±—é–ª–µ—Ç–µ–Ω–µ–±—Ä–æ–º–µ—Ç—ñ–≤.',
          politics:'–í–∏–±–æ—Ä–∏ —Ç—Ä–∏–≤–∞—é—Ç—å –ø–æ—Å—Ç—ñ–π–Ω–æ. –†–µ–∑—É–ª—å—Ç–∞—Ç–∏ –Ω—ñ–∫–æ–≥–æ –Ω–µ —Ö–≤–∏–ª—é—é—Ç—å.',
          zones:[
            {id:'z5',name:'–†–µ—Ñ–µ—Ä–µ–Ω–¥—É–º–Ω–∏–π –ö—Ä–∞—Ç–µ—Ä',danger:'–°–µ—Ä–µ–¥–Ω—è',unlocked:false,reward:{tickets:9,medals:2,puke:1}},
            {id:'z6',name:'–®—Ç–∞–± –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—á—ñ–≤',danger:'–í–∏—Å–æ–∫–∞',unlocked:false,reward:{tickets:12,medals:3,puke:1}},
            {id:'z7',name:'–ê—Ä—Å–µ–Ω–∞–ª –ê—Ä–≥—É–º–µ–Ω—Ç—ñ–≤',danger:'–í–∏—Å–æ–∫–∞',unlocked:false,reward:{tickets:15,medals:3,puke:2}}
          ]
        }
      ]
    },
    {
      id:'g2',
      name:'–ì–∞–ª–∞–∫—Ç–∏–∫–∞ –ì—ñ–ø–µ—Ä–¥–µ–º–æ–∫—Ä–∞—Ç—ñ—ó',
      note:'–¢—É—Ç –ø–æ—á–∏–Ω–∞—î—Ç—å—Å—è —Å–ø—Ä–∞–≤–∂–Ω—î –±–æ–∂–µ–≤—ñ–ª–ª—è.',
      lore:'–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞ –æ–±–ª–∞—Å—Ç—å –∫–æ—Å–º–æ—Å—É, –¥–µ –∫–æ–∂–µ–Ω –ø–æ—Å—Ç—Ä—ñ–ª –º–∞—î –±—É—Ç–∏ —Å—Ö–≤–∞–ª–µ–Ω–∏–π –±—ñ–ª—å—à—ñ—Å—Ç—é –≥–æ–ª–æ—Å—ñ–≤. –ù–∞–≤—ñ—Ç—å —Ç—É—Ä–µ–ª—ñ –≥–æ–ª–æ—Å—É—é—Ç—å.',
      locked:true,
      planets:[]
    }
  ]
};
const loreHistory=[
  {id:'intro',name:'–ö–æ—Ç–æ–¥–µ–º–æ–∫—Ä–∞—Ç—ñ—è',text:'–£ –¥–∞–ª–µ–∫—ñ–π –≥–∞–ª–∞–∫—Ç–∏—Ü—ñ –∫–æ—Ç–∏ –π –ø–µ—Å–∏–∫–∏ –≤–∏—Ä—ñ—à–∏–ª–∏, —â–æ –¥–µ–º–æ–∫—Ä–∞—Ç—ñ—é —Ç—Ä–µ–±–∞ –Ω–µ—Å—Ç–∏ –≤—Å—ñ–º. –ù–∞–≤—ñ—Ç—å —Ç–∏–º, —Ö—Ç–æ –≤–∑–∞–≥–∞–ª—ñ –Ω–µ –ø—Ä–æ—Å–∏–≤.'},
  {id:'war',name:'–í–µ–ª–∏–∫–∏–π –ì—ñ–ø–µ—Ä–ø—É–∫',text:'–ü–µ—Ä—à–∏–π –≤–∏–±—É—Ö –ì—ñ–ø–µ—Ä–ø—É–∫—É –≤—ñ–¥–∫—Ä–∏–≤ –ø–æ—Ä—Ç–∞–ª–∏ –¥–æ –ø–ª–∞–Ω–µ—Ç –º—É—Ç–∞–Ω—Ç—ñ–≤. –í—Å—ñ –∑—Ä–æ–±–∏–ª–∏ –≤–∏–≥–ª—è–¥, —â–æ —Ç–∞–∫ —ñ –ø–ª–∞–Ω—É–≤–∞–ª–æ—Å—å.'}
];
const statusPhrases=[
  '–ö–∞–ø—ñ—Ç–∞–Ω: ¬´–•—Ç–æ –∑–Ω–æ–≤—É –ø—É–∫–Ω—É–≤ —É —à–ª—é–∑?¬ª',
  '–†–∞–¥–∞ –ö–æ—Ç—ñ–≤: ¬´–ì–æ–ª–æ—Å—É–≤–∞–Ω–Ω—è –∑–∞ –±–æ–º–±—É–≤–∞–Ω–Ω—è —Ç—Ä–∏–≤–∞—î‚Ä¶¬ª',
  '–°–µ—Ä–≤–µ—Ä: ¬´–ü—É–∫–ª—ñ–Ω–≥–∏ —Ç–µ–∂ –æ–Ω–ª–∞–π–Ω¬ª',
  '–®—Ç–∞–±: ¬´–Ø–∫—â–æ –Ω–µ –∑–Ω–∞—î—à, —â–æ —Ä–æ–±–∏—Ç–∏ ‚Äî –≤–∏—Å–∞–¥–∏—Å—è —â–µ —Ä–∞–∑¬ª'
];
const catFacts=[
  '–ü—É–∫–ª—ñ–Ω–≥–∏ –±–æ—è—Ç—å—Å—è –±—é–ª–µ—Ç–µ–Ω—ñ–≤ –±—ñ–ª—å—à–µ, –Ω—ñ–∂ —Ç—É—Ä–µ–ª–µ–π.',
  '–û—Ñ—ñ—Ü—ñ–π–Ω–æ –ì—ñ–ø–µ—Ä–ø—É–∫ –≤–≤–∞–∂–∞—î—Ç—å—Å—è —á–∏—Å—Ç–æ—é –µ–Ω–µ—Ä–≥—ñ—î—é. –ù–µ–æ—Ñ—ñ—Ü—ñ–π–Ω–æ ‚Äî —Ö—Ç–æ–Ω—ñ—á–Ω–∏–º –∑–∞–ø–∞—Ö–æ–º –¥–µ–º–æ–∫—Ä–∞—Ç—ñ—ó.',
  '–ö–æ–∂–Ω–∞ —Ç—Ä–µ—Ç—è –¥–µ–º–æ–º–µ–¥–∞–ª—å–∫–∞ –≤–∏–¥–∞—î—Ç—å—Å—è –ø–æ–º–∏–ª–∫–æ–≤–æ, –∞–ª–µ –Ω—ñ–∫–æ–º—É –Ω–µ —Ö–æ—á–µ—Ç—å—Å—è —Ä–æ–∑–±–∏—Ä–∞—Ç–∏—Å—å.',
  '–ö–æ—Ç–∏ –¥–µ—Å–∞–Ω—Ç—É –≤–≤–∞–∂–∞—é—Ç—å, —â–æ –Ω–∞–π–Ω–µ–±–µ–∑–ø–µ—á–Ω—ñ—à–∏–π –≤–æ—Ä–æ–≥ ‚Äî —Ü–µ –≥–æ–ª–æ–¥–Ω–∏–π –ø–µ—Å–∏–∫ –Ω–∞ –±–∞–∑—ñ.'
];
// –°—Ç–∞–Ω –≥—Ä–∞–≤—Ü—è (–∑–∞–≥–ª—É—à–∫–∞)
const playerState={
  playerName:'–ü–æ—Ö–µ—Ä–æ–∫–æ—Ç–æ',
  avatarId:'poherocat',
  lastGalaxyId:'g1',
  lastPlanetId:'p1',
  lastZoneId:'z1',
  lastSessionLabel:'–†–∞–¥—ñ–æ',
  clearedZones:{z1:true}
};
// —Å–ø—Ä–æ–±–∞ –ø—ñ–¥–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ —ñ–º'—è –≥—Ä–∞–≤—Ü—è –∑ localStorage
try{
  const savedName = localStorage.getItem('pc_player_name');
  if(savedName){
    playerState.playerName = savedName;
  }
  const savedAvatar = localStorage.getItem('pc_player_avatar');
  if(savedAvatar){
    playerState.avatarId = savedAvatar;
  }
}catch(e){}

// –ó–∞–≥–∞–ª—å–Ω–∏–π —Å—Ç–∞–Ω –º–µ–Ω—é
let currentScreen='home';
let currentGalaxy=gameData.galaxies[0];
let currentPlanet=currentGalaxy.planets[0];
let currentZone=null;
let toastTimer=null;let vibroOn=true;let dropdownOpen=false;
const $=id=>document.getElementById(id);
function vibro(){if(!vibroOn)return;if(navigator.vibrate)navigator.vibrate(10)}
function showToast(msg){const t=$('toast');t.textContent=msg;t.classList.add('visible');clearTimeout(toastTimer);toastTimer=setTimeout(()=>t.classList.remove('visible'),1900)}
function switchScreen(target){
  if(target===currentScreen) return;
  const from = $('screen-'+currentScreen);
  const to   = $('screen-'+target);
  if(!from||!to) return;
  vibro();
  from.classList.remove('active');
  to.classList.add('active');
  currentScreen = target;
  updateSteppers();
}

function updateSteppers(){
  const screens = ['galaxies','planets','zones'];
  screens.forEach(scr=>{
    const root = $('screen-'+scr);
    if(!root) return;
    const gal = root.querySelector('.step-gal');
    const pl  = root.querySelector('.step-pl');
    const zn  = root.querySelector('.step-zn');
    [gal,pl,zn].forEach(el=>{ if(el) el.classList.remove('active','done'); });
    if(currentScreen==='galaxies'){
      if(gal) gal.classList.add('active');
    }else if(currentScreen==='planets'){
      if(gal) gal.classList.add('done');
      if(pl)  pl.classList.add('active');
    }else if(currentScreen==='zones'){
      if(gal) gal.classList.add('done');
      if(pl)  pl.classList.add('done');
      if(zn)  zn.classList.add('active');
    }
  });
}
function toggleDropdown(force){const d=$('resDropdown');dropdownOpen=force!==undefined?force:!dropdownOpen;d.classList.toggle('visible',dropdownOpen)}
// –î–æ–ø–æ–º—ñ–∂–Ω—ñ –¥–ª—è –ø—Ä–æ–≥—Ä–µ—Å—É
function getAllCounts(){
  let totalGal=gameData.galaxies.length;
  let totalPl=0;let totalZn=0;
  gameData.galaxies.forEach(g=>{
    const pls=g.planets||[];
    totalPl+=pls.length;
    pls.forEach(p=>{totalZn+=(p.zones||[]).length;});
  });
  return {totalGal,totalPl,totalZn};
}
function getClearedCounts(){
  const clearedIds=new Set(Object.keys(playerState.clearedZones||{}));
  let clearedZn=0;let clearedPl=0;let clearedGal=0;
  gameData.galaxies.forEach(g=>{
    let galaxyHasCleared=false;
    (g.planets||[]).forEach(p=>{
      let planetHasCleared=false;
      (p.zones||[]).forEach(z=>{
        if(clearedIds.has(z.id)){
          clearedZn++;planetHasCleared=true;galaxyHasCleared=true;
        }
      });
      if(planetHasCleared)clearedPl++;
    });
    if(galaxyHasCleared)clearedGal++;
  });
  return {clearedGal,clearedPl,clearedZn};
}
// –†–µ–Ω–¥–µ—Ä –≥–∞–ª–∞–∫—Ç–∏–∫
function renderGalaxies(){const name=$('galaxyName'),meta=$('galaxyMeta'),list=$('galaxyList');name.textContent=currentGalaxy.name;meta.textContent=currentGalaxy.note||'';list.innerHTML='';gameData.galaxies.forEach(g=>{const div=document.createElement('div');div.className='item';if(g.locked)div.classList.add('locked');if(g.id===currentGalaxy.id)div.classList.add('active');div.innerHTML=`<div class="item-main"><div class="item-name">ü™ê ${g.name}</div><div class="item-note">${g.note||''}</div></div><div class="item-tag">${g.locked?'Locked':'Tap'}</div>`;div.onclick=()=>{vibro();if(g.locked)return showToast('–ì–∞–ª–∞–∫—Ç–∏–∫–∞ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∞');currentGalaxy=g;currentPlanet=g.planets[0];currentZone=null;renderGalaxies();renderPlanets();switchScreen('planets');};list.appendChild(div);});}
// –†–µ–Ω–¥–µ—Ä –ø–ª–∞–Ω–µ—Ç
function renderPlanets(){const crumbs=$('planetCrumbs'),name=$('planetName'),meta=$('planetMeta'),list=$('planetList');crumbs.textContent=currentGalaxy.name+' ‚Ä¢ –ü–ª–∞–Ω–µ—Ç–∏';if(!currentPlanet){name.textContent='–ù–µ–º–∞—î –ø–ª–∞–Ω–µ—Ç';meta.textContent='';list.innerHTML='';return;}name.textContent=currentPlanet.name;meta.textContent=currentPlanet.note||'';list.innerHTML='';(currentGalaxy.planets||[]).forEach(p=>{const div=document.createElement('div');div.className='item';if(p.id===currentPlanet.id)div.classList.add('active');div.innerHTML=`<div class="item-main"><div class="item-name">ü™ê ${p.name}</div><div class="item-note">${p.lore||p.note||''}</div></div><div class="item-tag">Tap</div>`;div.onclick=()=>{vibro();currentPlanet=p;currentZone=null;renderPlanets();renderZones();switchScreen('zones');};list.appendChild(div);});}
function dangerLabel(d){switch(d){case'–õ–µ–≥–∫–∞':return'LOW';case'–°–µ—Ä–µ–¥–Ω—è':return'MID';case'–í–∏—Å–æ–∫–∞':return'HIGH';default:return d||'?';}}
// –†–µ–Ω–¥–µ—Ä –∑–æ–Ω + –º—ñ—Å—ñ—è
function renderZones(){const crumbs=$('zoneCrumbs'),grid=$('zoneGrid'),headerInfo=$('zoneHeaderInfo');crumbs.textContent=currentGalaxy.name+' ‚Ä¢ '+(currentPlanet?currentPlanet.name:'?')+' ‚Ä¢ –ó–æ–Ω–∏';headerInfo.textContent='–ì–∞–ª–∞–∫—Ç–∏–∫–∞: '+currentGalaxy.name+' ‚Ä¢ –ü–ª–∞–Ω–µ—Ç–∞: '+(currentPlanet?currentPlanet.name:'?');grid.innerHTML='';if(!currentPlanet)return;currentPlanet.zones.forEach((z,i)=>{const tile=document.createElement('div');tile.className='zone-tile '+(z.unlocked?'unlocked':'locked');tile.innerHTML=`<div class="zone-label"><span class="zone-num">Zone ${i+1}</span><span class="zone-danger">${dangerLabel(z.danger)}</span></div>`;tile.onclick=()=>{vibro();if(!z.unlocked)return showToast('–ó–æ–Ω–∞ –ø–æ–∫–∏ –∑–∞–±–ª–æ–∫–æ–≤–∞–Ω–∞');currentZone=z;playerState.lastGalaxyId=currentGalaxy.id;playerState.lastPlanetId=currentPlanet.id;playerState.lastZoneId=z.id;updateMissionCard();updateHomeProgress();};grid.appendChild(tile);});updateMissionCard();}
function rewardToText(reward){if(!reward)return'–ù–∞–≥–æ—Ä–æ–¥–∞: ‚Äî';const parts=[];if(reward.tickets)parts.push('üé´ +'+reward.tickets);if(reward.medals)parts.push('üèÖ +'+reward.medals);if(reward.puke)parts.push('üí® +'+reward.puke);return '–ù–∞–≥–æ—Ä–æ–¥–∞: '+(parts.join(' ')||'‚Äî');}
function updateMissionCard(){const title=$('missionTitle'),desc=$('missionDesc'),rewardEl=$('missionReward');if(!currentZone){title.textContent='–û–±–µ—Ä–∏ –∑–æ–Ω—É –¥–ª—è –≤–∏—Å–∞–¥–∫–∏';desc.textContent='–ö–ª—ñ–∫–Ω–∏ –ø–æ –≤—ñ–¥–∫—Ä–∏—Ç—ñ–π –∑–æ–Ω—ñ, —â–æ–± –ø–æ–±–∞—á–∏—Ç–∏ –¥–µ—Ç–∞–ª—ñ –º—ñ—Å—ñ—ó.';rewardEl.textContent='–ù–∞–≥–æ—Ä–æ–¥–∞: ‚Äî';return;}title.textContent='–ú—ñ—Å—ñ—è: '+currentZone.name;desc.textContent='–û–±–æ—Ä–æ–Ω–∞ –ø–æ–∑–∏—Ü—ñ—ó –ø—Ä–æ—Ç–∏ –ü—É–∫–ª—ñ–Ω–≥—ñ–≤. –†–µ–∫–æ–º–µ–Ω–¥–æ–≤–∞–Ω–æ: —Ç—É—Ä–µ–ª—ñ, –∫—ñ—Ç —ñ–∑ –Ω–æ—Ä–º–∞–ª—å–Ω–∏–º–∏ –Ω–µ—Ä–≤–∞–º–∏.';rewardEl.textContent=rewardToText(currentZone.reward);} 
// –ö–æ—Ç–æ–ø–µ–¥—ñ—è –∑ –∞–∫–æ—Ä–¥–µ–æ–Ω–æ–º + —Å—Ç–∞—Ç—É—Å–∞–º–∏
function buildCatopedia(){
  const clearedIds=new Set(Object.keys(playerState.clearedZones||{}));
  const cats=[];
  // –Ü—Å—Ç–æ—Ä—ñ—è –∑–∞–≤–∂–¥–∏ –≤—ñ–¥–∫—Ä–∏—Ç–∞
  cats.push({id:'lore',name:'–Ü—Å—Ç–æ—Ä—ñ—è',entries:loreHistory.map(e=>({
    id:e.id,name:e.name,text:e.text,open:true
  }))});
  // –ì–∞–ª–∞–∫—Ç–∏–∫–∏
  cats.push({id:'galaxies',name:'–ì–∞–ª–∞–∫—Ç–∏–∫–∏',entries:gameData.galaxies.map(g=>{
    let open=false;
    (g.planets||[]).forEach(p=>{(p.zones||[]).forEach(z=>{if(clearedIds.has(z.id))open=true;});});
    return {id:g.id,name:g.name,text:g.lore||g.note||'',open};
  })});
  // –ü–ª–∞–Ω–µ—Ç–∏
  cats.push({id:'planets',name:'–ü–ª–∞–Ω–µ—Ç–∏',entries:gameData.galaxies.flatMap(g=>(g.planets||[]).map(p=>{
    let open=false;(p.zones||[]).forEach(z=>{if(clearedIds.has(z.id))open=true;});
    return {id:p.id,name:p.name,text:p.lore||p.note||'',open};
  }))});
  // –†–µ—Å—É—Ä—Å–∏ ‚Äì –≤–≤–∞–∂–∞—î–º–æ –≤—ñ–¥–æ–º–∏–º–∏ –∑ –ø–æ—á–∞—Ç–∫—É –≥—Ä–∏
  cats.push({id:'resources',name:'–†–µ—Å—É—Ä—Å–∏',entries:dataResources.map(r=>({
    id:r.id,name:`${r.icon} ${r.name}`,text:r.desc,open:true
  }))});
  // –Æ–Ω—ñ—Ç–∏ ‚Äì —Ç–µ–∂ –≤—ñ–¥–æ–º—ñ
  cats.push({id:'units',name:'–Æ–Ω—ñ—Ç–∏ (–ü—Å–∏–∫–æ—Ç–∏)',entries:dataUnits.map(u=>({
    id:u.id,name:`${u.icon} ${u.name}`,text:u.desc,open:true
  }))});
  // –í–æ—Ä–æ–≥–∏ ‚Äì –≤—ñ–¥–∫—Ä–∏–≤–∞—é—Ç—å—Å—è –∫–æ–ª–∏ —î —Ö–æ—á –æ–¥–Ω–∞ –æ—á–∏—â–µ–Ω–∞ –∑–æ–Ω–∞
  const anyCleared=clearedIds.size>0;
  cats.push({id:'enemies',name:'–í–æ—Ä–æ–≥–∏ (–ó–ª—é–∫–ª–∏–Ω–≥–∏)',entries:dataEnemies.map(e=>({
    id:e.id,name:`${e.icon} ${e.name}`,text:e.desc,open:anyCleared
  }))});
  return {categories:cats};
}
let catopediaData=buildCatopedia();
function renderCatopedia(){const wrap=$('catList');if(!wrap)return;wrap.innerHTML='';catopediaData.categories.forEach(cat=>{const panel=document.createElement('div');panel.className='cat-panel';const head=document.createElement('div');head.className='cat-header';head.innerHTML=`<span class="cat-title-txt">${cat.name}</span><span class="cat-arrow">‚ñ∂</span>`;const body=document.createElement('div');body.className='cat-body';cat.entries.forEach(e=>{const row=document.createElement('div');row.className='cat-entry';const name=document.createElement('div');name.className='cat-entry-name';const nameSpan=document.createElement('span');nameSpan.textContent=e.name;const statusSpan=document.createElement('span');statusSpan.className='cat-entry-status';statusSpan.textContent=e.open?'üîì –í—ñ–¥–∫—Ä–∏—Ç–æ':'üîí –©–µ –Ω–µ –±–∞—á–∏–ª–∏';name.appendChild(nameSpan);name.appendChild(statusSpan);const text=document.createElement('div');text.className='cat-entry-text';text.textContent=e.text;row.appendChild(name);row.appendChild(text);body.appendChild(row);});head.onclick=()=>{const open=panel.classList.toggle('open');if(open){body.style.maxHeight=(body.scrollHeight+12)+'px';}else{body.style.maxHeight='0px';}};panel.appendChild(head);panel.appendChild(body);wrap.appendChild(panel);});}
function updateCatopediaFact(){const el=$('catFact');if(!el)return;const msg=catFacts[Math.floor(Math.random()*catFacts.length)];el.textContent='üì° –†–∞–¥—ñ–æ: '+msg;}
// –ü—Ä–æ–≥—Ä–µ—Å –Ω–∞ –≥–æ–ª–æ–≤–Ω–æ–º—É –µ–∫—Ä–∞–Ω—ñ (–∑–≤—ñ–ª—å–Ω–µ–Ω–æ X/Y)
function updateHomeProgress(){const counts=getAllCounts();const cleared=getClearedCounts();$('badgeGalaxy').textContent=cleared.clearedGal+'/'+counts.totalGal+' –≥–∞–ª–∞–∫—Ç–∏–∫';$('badgePlanet').textContent=cleared.clearedPl+'/'+counts.totalPl+' –ø–ª–∞–Ω–µ—Ç';$('badgeZone').textContent=cleared.clearedZn+'/'+counts.totalZn+' –∑–æ–Ω';const nameEl=$('playerNameDisplay');if(nameEl){nameEl.textContent=playerState.playerName||'–ü–æ—Ö–µ—Ä–æ–∫–æ—Ç–æ';}}
function updateStatusLine(){const status=$('statusLine');const phrase=statusPhrases[Math.floor(Math.random()*statusPhrases.length)];status.textContent='üìü '+playerState.lastSessionLabel+' ‚Ä¢ '+phrase;}
// –Ü–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∏–π —Å—Ç–µ–ø–ø–µ—Ä
function goToLevel(level){
  if(level==='galaxies'){
    currentGalaxy=gameData.galaxies[0]||currentGalaxy;
    currentPlanet=currentGalaxy.planets[0]||currentPlanet;
    currentZone=null;
    renderGalaxies();
    renderPlanets();
    renderZones();
    switchScreen('galaxies');
  }else if(level==='planets'){
    if(!currentGalaxy.planets||!currentGalaxy.planets.length){
      showToast('–ù–µ–º–∞—î –ø–ª–∞–Ω–µ—Ç');
      return;
    }
    if(!currentPlanet)currentPlanet=currentGalaxy.planets[0];
    renderPlanets();
    renderZones();
    switchScreen('planets');
  }else if(level==='zones'){
    if(!currentPlanet||!currentPlanet.zones||!currentPlanet.zones.length){
      showToast('–ù–µ–º–∞—î –∑–æ–Ω');
      return;
    }
    renderZones();
    switchScreen('zones');
  }
}
// –§—É–Ω–∫—Ü—ñ—ó –¥–ª—è –∑–∞—Å—Ç–æ—Å—É–≤–∞–Ω–Ω—è —Å–∫—ñ–Ω–∞ —Ç–∞ –Ω–∞–ø–æ–≤–Ω–µ–Ω–Ω—è –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω—å

let settingsOpen=false;

function applyAvatarMeta(skin){
  if(!skin) return;

  // –æ–Ω–æ–≤–ª—é—î–º–æ —ñ–º‚Äô—è –≥–µ—Ä–æ—è
  playerState.playerName = skin.heroName || skin.name || playerState.playerName;
  try{
    localStorage.setItem('pc_player_name', playerState.playerName);
  }catch(e){}

  // –æ–Ω–æ–≤–ª—é—î–º–æ —Ç–µ–∫—Å—Ç –Ω–∞ –≥–æ–ª–æ–≤–Ω–æ–º—É –µ–∫—Ä–∞–Ω—ñ
  updateHomeProgress();

  // –æ–Ω–æ–≤–ª—é—î–º–æ –æ–ø–∏—Å –≥–µ—Ä–æ—è, —è–∫—â–æ —î
  const descEl = $('homeDesc');
  if(descEl && skin.heroDesc){
    descEl.textContent = skin.heroDesc;
  }
}


function applyAvatarSkin(){
  const el = $('playerAvatar');
  if(!el) return;
  const skin = avatarSkins.find(s=>s.id===playerState.avatarId) || avatarSkins[0];
  if(!skin) return;

  // –∫–∞—Ä—Ç–∏–Ω–∫–∞
  el.style.backgroundImage = `url('${skin.file}')`;
  el.title = skin.name;

  // —ñ–º‚Äô—è + –æ–ø–∏—Å
  applyAvatarMeta(skin);
}

function openHeroModal(){
  const modal = $('heroModal');
  if(!modal) return;

  const skin = avatarSkins.find(s=>s.id===playerState.avatarId) || avatarSkins[0];
  if(!skin) return;

  const nameEl = $('heroModalName');
  const imgEl  = $('heroModalImage');
  const descEl = $('heroModalDesc');

  if(nameEl) nameEl.textContent = skin.heroName || skin.name || '–ì–µ—Ä–æ–π';
  if(imgEl)  imgEl.style.backgroundImage = `url('${skin.file}')`;
  if(descEl) descEl.textContent = skin.heroDesc || '–¢–∞—î–º–Ω–∏—á–∏–π –≥–µ—Ä–æ–π –±–µ–∑ –æ–ø–∏—Å—É.';

  modal.classList.add('visible');
  vibro();
}

function closeHeroModal(){
  const modal = $('heroModal');
  if(!modal) return;
  modal.classList.remove('visible');
}




function buildSettingsAvatars(){
  const wrap = $('settingsAvatars');
  if(!wrap) return;
  wrap.innerHTML = '';
  avatarSkins.forEach(skin=>{
    const btn = document.createElement('button');
    btn.className = 'avatar-btn';
    if(skin.id === playerState.avatarId) btn.classList.add('active');
    btn.innerHTML =
      `<div class="avatar-thumb" style="background-image:url('${skin.file}')" title="${skin.name}"></div>`;
    btn.onclick = ()=>{
      vibro();
      playerState.avatarId = skin.id;
      try{ localStorage.setItem('pc_player_avatar', skin.id); }catch(e){}
      applyAvatarSkin();
      buildSettingsAvatars();
      showToast('–•–µ—Ä–æ—è –∑–º—ñ–Ω–µ–Ω–æ: '+skin.name);
    };
    wrap.appendChild(btn);
  });
}


function toggleSettings(force){
  const s = $('settingsDropdown');
  if(!s) return;
  settingsOpen = (force!==undefined)?force:!settingsOpen;
  s.classList.toggle('visible', settingsOpen);
}


// INIT
function init(){
  renderGalaxies();
  renderPlanets();
  renderZones();
  catopediaData=buildCatopedia();
  renderCatopedia();
  updateCatopediaFact();
  updateHomeProgress();
  updateStatusLine();
  applyAvatarSkin();
buildSettingsAvatars();


  $('btnStart').onclick=()=>{currentGalaxy=gameData.galaxies[0];currentPlanet=currentGalaxy.planets[0];currentZone=null;renderGalaxies();renderPlanets();renderZones();const orb=$('galaxyOrb');orb.classList.add('warp');setTimeout(()=>orb.classList.remove('warp'),320);switchScreen('galaxies');};
  $('btnContinue').onclick=()=>{const g=gameData.galaxies.find(x=>x.id===playerState.lastGalaxyId)||gameData.galaxies[0];const p=(g.planets||[]).find(x=>x.id===playerState.lastPlanetId)||g.planets[0];currentGalaxy=g;currentPlanet=p;currentZone=(p.zones||[]).find(z=>z.id===playerState.lastZoneId)||p.zones[0];renderGalaxies();renderPlanets();renderZones();switchScreen('zones');showToast('–ü—Ä–æ–¥–æ–≤–∂—É—î–º–æ –º—ñ—Å—ñ—é');};
  $('btnModes').onclick=()=>{catopediaData=buildCatopedia();renderCatopedia();updateCatopediaFact();switchScreen('catopedia');};
  $('btnLaunchMission').onclick=()=>{if(!currentZone){showToast('–°–ø–æ—á–∞—Ç–∫—É –æ–±–µ—Ä–∏ –∑–æ–Ω—É');return;}showToast('–ó–∞–ø—É—Å–∫ –º—ñ—Å—ñ—ó: '+currentZone.name);};
  $('btnCoin').onclick=()=>{vibro();toggleDropdown();};
const btnSettings = $('btnSettings');
if(btnSettings){
  btnSettings.onclick = ()=>{
    vibro();
    toggleSettings();
  };
}


  const avatarEl = $('playerAvatar');
  if(avatarEl){
    avatarEl.onclick = ()=>{
      openHeroModal();
    };
  }



    const heroClose = $('heroModalClose');
  if(heroClose){
    heroClose.onclick = ()=>{
      closeHeroModal();
    };
  }

  const heroModal = $('heroModal');
  if(heroModal){
    heroModal.addEventListener('click', (e)=>{
      // –∫–ª—ñ–∫ –ø–æ –∑–∞—Ç–µ–º–Ω–µ–Ω–æ–º—É —Ñ–æ–Ω—É –∑–∞–∫—Ä–∏–≤–∞—î, –∞–ª–µ –Ω–µ –ø–æ —Å–∞–º—ñ–π –∫–∞—Ä—Ç—Ü—ñ
      if(e.target === heroModal){
        closeHeroModal();
      }
    });
  }




  Array.from(document.querySelectorAll('.back-btn')).forEach(b=>{b.onclick=()=>{const target=b.getAttribute('data-back');switchScreen(target);};});
  $('galaxyOrb').onclick=()=>{vibro();$('galaxyOrb').classList.add('warp');setTimeout(()=>$('galaxyOrb').classList.remove('warp'),320);switchScreen('planets');};
  $('planetOrb').onclick=()=>{vibro();$('planetOrb').classList.add('warp');setTimeout(()=>$('planetOrb').classList.remove('warp'),320);switchScreen('zones');};
  ['titleMain','gameLogo'].forEach(id=>{  const el = $(id);  if(el){    el.onclick = ()=>{ switchScreen('home'); };  }
});

  // —ñ–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ñ —Å—Ç–µ–ø–ø–µ—Ä–∏
  document.querySelectorAll('.step-item').forEach(el=>{
    const lvl=el.dataset.target;
    if(!lvl)return;
    el.addEventListener('click',()=>goToLevel(lvl));
  });

  // –∫–ª—ñ–∫ –ø–æ —ñ–º–µ–Ω—ñ –≥—Ä–∞–≤—Ü—è –¥–ª—è –∑–º—ñ–Ω–∏ –Ω—ñ–∫—É
  const nameEl = $('playerNameDisplay');
  if(nameEl){
    nameEl.onclick = ()=>{
      const currentName = playerState.playerName || '';
      const newName = prompt('–í–≤–µ–¥–∏ —ñ–º\'—è –≥—Ä–∞–≤—Ü—è:', currentName);
      if(newName && newName.trim()){
        playerState.playerName = newName.trim();
        try{ localStorage.setItem('pc_player_name', playerState.playerName); }catch(e){}
        nameEl.textContent = playerState.playerName;
      }
    };
  }

document.addEventListener('click',e=>{
  const d = $('resDropdown');
  const coin = $('btnCoin');
  if(d && !d.contains(e.target) && e.target!==coin && dropdownOpen){
    toggleDropdown(false);
  }
  const s = $('settingsDropdown');
  const settingsBtn = $('btnSettings');
  if(s && !s.contains(e.target) && e.target!==settingsBtn && settingsOpen){
    toggleSettings(false);
  }
});
}
window.addEventListener('DOMContentLoaded',()=>{
  init();

function loadIconWithFallback(el, imgPath){
  const testImg = new Image();
  testImg.onload = () => {
    el.style.backgroundImage = `url('${imgPath}')`;
    el.textContent = '';
  };
  testImg.onerror = () => {
    el.style.backgroundImage = 'none';
    el.textContent = el.dataset.emoji || '‚ùî';
  };
  testImg.src = imgPath;
}
loadIconWithFallback($('btnSettings'), 'images/icon_setup.png');
loadIconWithFallback($('btnCoin'), 'images/icon_coin.png');
loadIconWithFallback($('iconCatopedia'), 'images/icon_catopedia.png');



  updateSteppers();
});
</script>
</body>
</html>
